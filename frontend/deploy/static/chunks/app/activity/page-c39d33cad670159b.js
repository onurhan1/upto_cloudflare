(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[866],{849:(e,t,a)=>{Promise.resolve().then(a.bind(a,7332))},5365:(e,t,a)=>{"use strict";a.d(t,{Fc:()=>n,TN:()=>c});var s=a(5155),r=a(2115),l=a(2085),i=a(9434);let d=(0,l.F)("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),n=r.forwardRef((e,t)=>{let{className:a,variant:r,...l}=e;return(0,s.jsx)("div",{ref:t,role:"alert",className:(0,i.cn)(d({variant:r}),a),...l})});n.displayName="Alert",r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("h5",{ref:t,className:(0,i.cn)("mb-1 font-medium leading-none tracking-tight",a),...r})}).displayName="AlertTitle";let c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("text-sm [&_p]:leading-relaxed",a),...r})});c.displayName="AlertDescription"},6695:(e,t,a)=>{"use strict";a.d(t,{BT:()=>c,Wu:()=>o,ZB:()=>n,Zp:()=>i,aR:()=>d});var s=a(5155),r=a(2115),l=a(9434);let i=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("rounded-xl border bg-card text-card-foreground shadow",a),...r})});i.displayName="Card";let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",a),...r})});d.displayName="CardHeader";let n=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("font-semibold leading-none tracking-tight",a),...r})});n.displayName="CardTitle";let c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",a),...r})});c.displayName="CardDescription";let o=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("p-6 pt-0",a),...r})});o.displayName="CardContent",r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("flex items-center p-6 pt-0",a),...r})}).displayName="CardFooter"},7332:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>_});var s=a(5155),r=a(2115),l=a(5695),i=a(5731),d=a(5290),n=a(1324),c=a(2895);let o=(0,c.A)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);var u=a(7924),x=a(9397),v=a(1007);let m=(0,c.A)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);var p=a(285),h=a(2523),g=a(6695),f=a(8856),j=a(5365),b=a(6126),y=a(9409),N=a(757);let w={"user.login":"bg-blue-500/20 text-blue-400","service.create":"bg-green-500/20 text-green-400","service.update":"bg-yellow-500/20 text-yellow-400","service.delete":"bg-red-500/20 text-red-400","incident.create":"bg-orange-500/20 text-orange-400","incident.update":"bg-yellow-500/20 text-yellow-400","incident.resolve":"bg-green-500/20 text-green-400","status_page.create":"bg-purple-500/20 text-purple-400","status_page.update":"bg-purple-500/20 text-purple-400","integration.update":"bg-cyan-500/20 text-cyan-400"},C={"user.login":"User Login","service.create":"Service Created","service.update":"Service Updated","service.delete":"Service Deleted","incident.create":"Incident Created","incident.update":"Incident Updated","incident.resolve":"Incident Resolved","status_page.create":"Status Page Created","status_page.update":"Status Page Updated","integration.update":"Integration Updated"};function _(){let e=(0,l.useRouter)(),{currentOrganization:t,loading:a}=(0,d.Z)(),[c,_]=(0,r.useState)([]),[A,S]=(0,r.useState)(!0),[k,R]=(0,r.useState)(""),[U,I]=(0,r.useState)({action:void 0,resource_type:void 0,search:""}),[L,E]=(0,r.useState)({total:0,limit:50,offset:0,has_more:!1});(0,r.useEffect)(()=>{t&&!a?F():a||t||(S(!1),R("Please select an organization"))},[t,a,U.action,U.resource_type]);let F=async()=>{if(!t)return void S(!1);S(!0);try{let t=await i.F.getAuditLogs({action:U.action,resource_type:U.resource_type,limit:L.limit,offset:L.offset});if(t.error)R(t.error),t.error.includes("Unauthorized")&&e.push("/login");else{var a,s;_((null==(a=t.data)?void 0:a.logs)||[]),E((null==(s=t.data)?void 0:s.pagination)||L)}}catch(e){R(e.message||"Failed to load activity logs")}finally{S(!1)}},P=c.filter(e=>{if(U.search){var t,a,s,r,l,i,d;let n=U.search.toLowerCase();return(null==(t=e.action)?void 0:t.toLowerCase().includes(n))||(null==(a=e.user_name)?void 0:a.toLowerCase().includes(n))||(null==(s=e.user_email)?void 0:s.toLowerCase().includes(n))||(null==(l=e.metadata)||null==(r=l.name)?void 0:r.toLowerCase().includes(n))||(null==(d=e.metadata)||null==(i=d.title)?void 0:i.toLowerCase().includes(n))}return!0});return a?(0,s.jsx)(n.A,{children:(0,s.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,s.jsx)(f.E,{className:"h-4 w-32"})})}):t?(0,s.jsx)(n.A,{children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Activity Timeline"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"View all activities and changes in your organization"})]})}),(0,s.jsxs)(g.Zp,{children:[(0,s.jsx)(g.aR,{children:(0,s.jsxs)(g.ZB,{className:"flex items-center gap-2",children:[(0,s.jsx)(o,{className:"h-5 w-5"}),"Filters"]})}),(0,s.jsx)(g.Wu,{children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(u.A,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,s.jsx)(h.p,{placeholder:"Search activities...",value:U.search,onChange:e=>I({...U,search:e.target.value}),className:"pl-9"})]}),(0,s.jsxs)(y.l6,{value:U.action||void 0,onValueChange:e=>I({...U,action:"all"===e?void 0:e}),children:[(0,s.jsx)(y.bq,{children:(0,s.jsx)(y.yv,{placeholder:"All Actions"})}),(0,s.jsxs)(y.gC,{children:[(0,s.jsx)(y.eb,{value:"all",children:"All Actions"}),(0,s.jsx)(y.eb,{value:"user.login",children:"User Login"}),(0,s.jsx)(y.eb,{value:"service.create",children:"Service Created"}),(0,s.jsx)(y.eb,{value:"service.update",children:"Service Updated"}),(0,s.jsx)(y.eb,{value:"service.delete",children:"Service Deleted"}),(0,s.jsx)(y.eb,{value:"incident.create",children:"Incident Created"}),(0,s.jsx)(y.eb,{value:"incident.update",children:"Incident Updated"}),(0,s.jsx)(y.eb,{value:"incident.resolve",children:"Incident Resolved"}),(0,s.jsx)(y.eb,{value:"status_page.create",children:"Status Page Created"}),(0,s.jsx)(y.eb,{value:"status_page.update",children:"Status Page Updated"}),(0,s.jsx)(y.eb,{value:"integration.update",children:"Integration Updated"})]})]}),(0,s.jsxs)(y.l6,{value:U.resource_type||void 0,onValueChange:e=>I({...U,resource_type:"all"===e?void 0:e}),children:[(0,s.jsx)(y.bq,{children:(0,s.jsx)(y.yv,{placeholder:"All Resources"})}),(0,s.jsxs)(y.gC,{children:[(0,s.jsx)(y.eb,{value:"all",children:"All Resources"}),(0,s.jsx)(y.eb,{value:"user",children:"User"}),(0,s.jsx)(y.eb,{value:"service",children:"Service"}),(0,s.jsx)(y.eb,{value:"incident",children:"Incident"}),(0,s.jsx)(y.eb,{value:"status_page",children:"Status Page"}),(0,s.jsx)(y.eb,{value:"integration",children:"Integration"})]})]}),(0,s.jsx)(p.$,{variant:"outline",onClick:F,children:"Refresh"})]})})]}),k&&(0,s.jsx)(j.Fc,{variant:"destructive",children:(0,s.jsx)(j.TN,{children:k})}),A?(0,s.jsx)("div",{className:"space-y-4",children:[1,2,3,4,5].map(e=>(0,s.jsx)(g.Zp,{children:(0,s.jsx)(g.Wu,{className:"pt-6",children:(0,s.jsx)(f.E,{className:"h-20 w-full"})})},e))}):0===P.length?(0,s.jsx)(g.Zp,{children:(0,s.jsx)(g.Wu,{className:"pt-6",children:(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(x.A,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No activity yet"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Activity logs will appear here as you use the platform"})]})})}):(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"absolute left-8 top-0 bottom-0 w-0.5 bg-border"}),(0,s.jsx)("div",{className:"space-y-6",children:P.map((e,t)=>{var a,r,l;let i;return(0,s.jsxs)("div",{className:"relative flex gap-4",children:[(0,s.jsx)("div",{className:"relative z-10 flex h-8 w-8 items-center justify-center rounded-full bg-background border-2 border-primary",children:(0,s.jsx)(x.A,{className:"h-4 w-4 text-primary"})}),(0,s.jsx)(g.Zp,{className:"flex-1",children:(0,s.jsx)(g.Wu,{className:"pt-6",children:(0,s.jsx)("div",{className:"flex items-start justify-between",children:(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsx)(b.E,{className:w[e.action]||"bg-gray-500/20 text-gray-400",children:C[i=e.action]||i.replace(/\./g," ").replace(/\b\w/g,e=>e.toUpperCase())}),e.resource_type&&(0,s.jsx)(b.E,{variant:"outline",children:e.resource_type})]}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground mb-2",children:[(null==(a=e.metadata)?void 0:a.name)||(null==(r=e.metadata)?void 0:r.title)||"Activity",(null==(l=e.metadata)?void 0:l.type)&&" (".concat(e.metadata.type,")")]}),(0,s.jsxs)("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[e.user_name&&(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(v.A,{className:"h-3 w-3"}),e.user_name]}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(m,{className:"h-3 w-3"}),(0,N.m)(new Date(1e3*e.created_at),{addSuffix:!0})]})]})]})})})})]},e.id)})})]}),L.has_more&&(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsx)(p.$,{variant:"outline",onClick:()=>{E({...L,offset:L.offset+L.limit}),F()},children:"Load More"})})]})}):(0,s.jsx)(n.A,{children:(0,s.jsx)(j.Fc,{variant:"destructive",children:(0,s.jsx)(j.TN,{children:"Please select an organization from the dropdown above."})})})}},8856:(e,t,a)=>{"use strict";a.d(t,{E:()=>l});var s=a(5155),r=a(9434);function l(e){let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,r.cn)("animate-pulse rounded-md bg-primary/10",t),...a})}}},e=>{e.O(0,[874,597,739,712,757,324,441,583,358],()=>e(e.s=849)),_N_E=e.O()}]);